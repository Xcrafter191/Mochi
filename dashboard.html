<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - YOCHI!</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Caveat+Brush&family=Chewy&family=DynaPuff:wdth,wght@87.5,400..700&family=Gabarito:wght@400..900&family=Jacquard+12&family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Margarine&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
    body {            
        font-family: "DynaPuff", serif;
        background-color: #fffdf0;
        color: #794874;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

/* Navbar Styles */
.navbar {
    background-color: 
    #fffdf0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    padding: 0;
    position: sticky;
    top: 0;
    z-index: 1000;
}

.navbar-content {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    gap: 100px;
    align-items: center;
    padding: 0.5rem 1rem;
}

.navbar-brand img {
    width: 130px;
    height: auto;
}

.navbar-links {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin: 0;
    padding: 0;
    list-style: none;
}

.navbar-links a {
    color: #794874;
    text-decoration: none;
    font-family: "DynaPuff", serif;
    font-size: 1rem;
    font-weight: 600;
    padding: 0.5rem 1rem;
    transition: color 0.2s ease;
}

.navbar-links a:hover {
    color: #ffcccc;
}

.navbar-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.navbar-actions button {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.5rem;
    color: #794874;
    padding: 0.5rem;
    transition: color 0.2s ease;
}

.navbar-actions button:hover {
    color: #ffcccc;
}

@media (max-width: 768px) {
    .navbar-links {
        display: none;
    }
    
    .navbar-content {
        justify-content: space-between;
    }
}

.dashboard-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 1rem;

  animation: slideIn 1s ease-in-out forwards;
}

@keyframes slideIn{
  from{
    transform: translateY(-100px);
    opacity: 0;
  }
  to{
    opacity: 1;
  }
}

h1,
h2 {
  font-family: "DynaPuff", sans-serif;
  color: #794874;
}

.dashboard-section {
  background-color: white;
  border-radius: 15px;
  padding: 1.5rem;
  margin-bottom: 2rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.status-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.status-item {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.status-item .material-symbols-outlined {
  font-size: 2.5rem;
  color: #794874;
}

.mochi-card {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background-color: #fbeee0;
  border-radius: 10px;
}

.mochi-card img {
  width: 100px;
  height: 100px;
  object-fit: cover;
  border-radius: 50%;
}

.mochi-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1rem;
}

.mochi-item {
  background-color: #fbeee0;
  border-radius: 10px;
  padding: 1rem;
  text-align: center;
}

.mochi-item img {
  width: 100%;
  height: 150px;
  object-fit: cover;
  border-radius: 10px;
  margin-bottom: 0.5rem;
}

.footer-container {
  background-color: #794874;
  margin-top: 2rem;
}

@media (max-width: 768px) {
  .status-container {
    flex-direction: column;
    align-items: flex-start;
  }

  .mochi-grid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  }
}

.product-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
}

.product-images {
    position: relative;
}

.product-images img {
    width: 100%;
    height: auto;
    border-radius: 10px;
    margin-bottom: 15px;
}

.product-info {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.product-info h2 {
    font-size: 24px;
    color: #794874;
    margin: 0;
}

.price {
    font-size: 28px;
    font-weight: bold;
    color: #794874;
}

.rating {
    display: flex;
    align-items: center;
    gap: 5px;
}

.star {
    color: #ffd700;
    font-size: 20px;
}

.actions {
    display: flex;
    gap: 10px;
    margin: 20px 0;
}

.actions button {
    flex: 1;
    padding: 12px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.2s;
}

.add-to-cart {
    background-color: #ffcccc;
    border: none;
    color: #794874;
}

.add-to-favorites {
    background-color: white;
    border: 2px solid #ffcccc;
    color: #794874;
}

.ingredients {
    margin-top: 20px;
}

.ingredients h3 {
    color: #794874;
    margin-bottom: 10px;
}

.reviews {
    margin-top: 20px;
}

.reviews h3 {
    color: #794874;
    margin-bottom: 10px;
}

.review-item {
    border-bottom: 1px solid #eee;
    padding: 10px 0;
}

.review-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 5px;
}

.review-rating {
    color: #ffd700;
}

.close {
    position: absolute;
    right: 20px;
    top: 20px;
    font-size: 28px;
    font-weight: bold;
    color: #794874;
    cursor: pointer;
}

.close:hover {
    color: #ffcccc;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    overflow-y: auto;
}

.modal-content {
    background-color: white;
    margin: 5% auto;
    padding: 30px;
    border-radius: 15px;
    width: 90%;
    max-width: 1000px;
    position: relative;
}

.mini-modal {
    position: fixed;
    top: 87px;
    right: 330px;
    background-color: white;
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 10px;
    width: 250px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    display: none;
}

.mini-modal h4 {
    margin: 0 0 10px;
    font-size: 16px;
}

.mini-modal ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.mini-modal li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
}

.mini-modal .quick-add {
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
}

.mini-modal .quick-add:hover {
    background-color: #0056b3;
}

.mini-modal .remove-favorite {
    background-color: #dc3545;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
    margin-left: 5px;
}

.mini-modal .remove-favorite:hover {
    background-color: #a71d2a;
}
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="/" class="navbar-brand">
                <img src="images/logo.png" alt="YOCHI! Logo">
            </a>
            <ul class="navbar-links">
                <li><a href="product.html">Products</a></li>
                <li><a href="contact.html">About Us</a></li>
                <li><a href="dashboard.html">Dashboard</a></li>
            </ul>
            <div class="navbar-actions">
                <button id="notificationsBtn" title="Notifications">üîî</button>
                <a href="layout-checkout.html"><button title="Cart">üõí</button></a>
                <button id="favoriteBtn" title="Favorites">ü§ç</button>
                <a href="profile.html"><button title="Profile">üë§</button></a>
            </div>
        </div>
    </nav>

    <div id="favoriteModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- Dashboard Content -->
    <div class="dashboard-container">
        <h1>Welcome to Your Dashboard</h1>
        
        <!-- Delivery Status -->
        <section class="dashboard-section" id="deliveryStatus">
            <h2>Delivery Status</h2>
            <div class="status-container">
                <div class="status-item">
                    <span class="material-symbols-outlined">local_shipping</span>
                    <p>Your order is on the way!</p>
                </div>
                <div class="status-details">
                    <p>Estimated delivery: <span id="estimatedDelivery">Loading...</span></p>
                    <p>Order number: <span id="orderNumber">Loading...</span></p>
                </div>
            </div>
        </section>

        <!-- Daily Mochi Recommendation -->
        <section class="dashboard-section" id="dailyRecommendation">
            <h2>Daily Mochi Recommendation</h2>
            <div class="mochi-card" id="recommendedMochi">
                <!-- Mochi recommendation will be inserted here by JavaScript -->
            </div>

                        <!-- Add modal structure -->
                        <div id="productModal" class="modal">
                            <div class="modal-content">
                                <span class="close">&times;</span>
                                <div id="modalContent"></div>
                            </div>
                        </div>
        </section>

        <!-- Most Popular Mochi -->
        <section class="dashboard-section" id="popularMochi">
            <h2>Most Popular Mochi</h2>
            <div class="mochi-grid" id="popularMochiGrid">
                <!-- Popular mochi will be inserted here by JavaScript -->
            </div>

                        <!-- Add modal structure -->
                        <div id="productModal" class="modal">
                            <div class="modal-content">
                                <span class="close">&times;</span>
                                <div id="modalContent"></div>
                            </div>
                        </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="text-white text-center py-4 footer-container">
        <div class="container">
            <p>&copy; 2025 YOCHI!. All rights reserved. Designed by Œ¶, Gerzz, Sredoznath, Pinoo, DMS</p>
            <a href="#!" class="text-white mx-2">Privacy Policy</a>
            <a href="#!" class="text-white mx-2">Terms of Service</a>
        </div>
    </footer>

    <script src="product.js"></script>
    <script>
        // Define DOM references
        const dom = {
    productModal: document.getElementById('productModal'),
    favoriteModal: document.getElementById('favoriteModal'),
    productGrid: document.getElementById('popularMochiGrid'),
    favoriteList: document.getElementById('favoriteList')
};

// Debugging: Log DOM references
console.log(dom);

// Function to get a random item from an array
function getRandomItem(array) {
  return array[Math.floor(Math.random() * array.length)]
}

// Function to format price
function formatPrice(price) {
  return `$${price.toFixed(2)}`
}

// Function to render star rating
function renderStarRating(rating) {
  const fullStars = Math.floor(rating)
  const halfStar = rating % 1 >= 0.5
  let stars = "‚òÖ".repeat(fullStars)
  if (halfStar) stars += "¬Ω"
  stars += "‚òÜ".repeat(5 - Math.ceil(rating))
  return stars
}

// Function to update delivery status
function updateDeliveryStatus() {
  const today = new Date()
  const deliveryDate = new Date(today.getTime() + 2 * 24 * 60 * 60 * 1000) // 2 days from now
  document.getElementById("estimatedDelivery").textContent = deliveryDate.toDateString()
  document.getElementById("orderNumber").textContent = `YM${Math.floor(Math.random() * 1000000)}`
}

// Function to update daily recommendation
function updateDailyRecommendation() {
  const recommendation = getRandomItem(products)
  const recommendationHtml = `
        <img src="${recommendation.image}" alt="${recommendation.name}">
        <div>
            <h3>${recommendation.name}</h3>
            <p>${recommendation.description}</p>
            <p>${renderStarRating(recommendation.rating)} (${recommendation.rating})</p>
            <p>${formatPrice(recommendation.price)}</p>
        </div>
    `
  document.getElementById("recommendedMochi").innerHTML = recommendationHtml
}

// Function to update popular mochi
function updatePopularMochi() {
  const popularMochi = products.sort(() => 0.5 - Math.random()).slice(0, 5) // Get 6 random mochi
  const popularMochiHtml = popularMochi
    .map(
      (mochi) => `
        <div class="mochi-item">
            <img src="${mochi.image}" alt="${mochi.name}">
            <h3>${mochi.name}</h3>
            <p>${renderStarRating(mochi.rating)} (${mochi.rating})</p>
            <p>${formatPrice(mochi.price)}</p>
        </div>
    `,
    )
    .join("")
  document.getElementById("popularMochiGrid").innerHTML = popularMochiHtml
}

function showProductModal(product) {
    console.log("showProductModal called for:", product.name); // Debugging line

    const modalContent = document.getElementById("modalContent");
    if (!modalContent) {
        console.error("Modal content element not found!");
        return;
    }

    // Check if the product is already favorited
    const favorites = JSON.parse(localStorage.getItem("favorites")) || [];
    const isFavorited = favorites.includes(product.name);

    modalContent.innerHTML = `
        <div class="product-details">
            <div class="product-images">
                <img src="${product.image}" alt="${product.name}" class="main-image">
            </div>
            <div class="product-info">
                <h2>${product.name}</h2>
                <div class="rating">${renderRating(product.rating)}</div>
                <div class="price">$${product.price.toFixed(2)}</div>
                <div class="actions">
                    <button class="add-to-cart" onclick="addToCart('${product.name}')">Add to Cart</button>
                    <button class="add-to-favorites" onclick="toggleFavorite('${product.name}')">
                        ${isFavorited ? "‚ù§Ô∏è Favorited" : "ü§ç Favorite"}
                    </button>
                </div>
                <div class="ingredients">
                    <h3>Ingredients</h3>
                    <p>Base: Sweet Rice Flour (Mochiko), Water, Sugar</p>
                    <p>Filling: Yogurt (Milk, Cream, Active Cultures), ${getIngredientsByFlavor(product.flavor)}</p>
                    <p>Contains: Milk, May contain traces of nuts</p>
                </div>
                <div class="reviews">
                    <h3>Customer Reviews</h3>
                    ${product.reviews.map(review => `
                        <div class="review-item">
                            <div class="review-header">
                                <strong>${review.user}</strong>
                                <span class="review-rating">${renderRating(review.rating)}</span>
                            </div>
                            <p>${review.comment}</p>
                        </div>
                    `).join("")}
                </div>
            </div>
        </div>
    `;

    if (dom.productModal) {
        dom.productModal.style.display = "block";
    } else {
        console.error("Product modal element not found!");
    }
}

function getIngredientsByFlavor(flavor) {
  const ingredients = {
    strawberry: "Natural Strawberry Puree, Natural Flavors, Beet Color",
    matcha: "Premium Matcha Green Tea Powder, Natural Flavors",
    mango: "Natural Mango Puree, Natural Flavors, Beta Carotene Color",
    chocolate: "Cocoa Powder, Natural Chocolate Flavor",
    blueberry: "Natural Blueberry Puree, Natural Flavors, Fruit and Vegetable Color",
    vanilla: "Natural Vanilla Extract, Vanilla Bean Seeds",
    lychee: "Natural Lychee Extract, Natural Flavors",
    durian: "Natural Durian Puree, Natural Flavors",
    "green apple": "Natural Apple Extract, Malic Acid, Natural Colors",
    "passion fruit": "Natural Passion Fruit Puree, Natural Flavors",
    coconut: "Coconut Cream, Natural Coconut Extract",
    pistachio: "Ground Pistachios, Natural Pistachio Extract, Natural Colors",
  }

  return ingredients[flavor.toLowerCase()] || "Natural Flavors"
}

        // Rating display function
        function renderRating(rating) {
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 >= 0.5;
    const emptyStars = 5 - Math.ceil(rating);
    
    return `
        ${'‚òÖ'.repeat(fullStars)}
        ${hasHalfStar ? '¬Ω' : ''}
        ${'‚òÜ'.repeat(emptyStars)}
        <span>(${rating})</span>
    `;
}

function addToCart(productName) {
    // Retrieve existing cart data from localStorage
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    // Check if the product is already in the cart
    const existingProduct = cart.find(item => item.name === productName);
    if (existingProduct) {
        existingProduct.quantity += 1; // Increment quantity
    } else {
        // Add new product to the cart
        cart.push({ name: productName, quantity: 1 });
    }

    // Save updated cart back to localStorage
    localStorage.setItem("cart", JSON.stringify(cart));

    console.log(`${productName} added to cart.`);
    alert(`${productName} added to cart!`);
}

function renderProducts(productsToRender) {
    dom.productGrid.innerHTML = ""; // Clear existing content
    productsToRender.forEach(product => {
        const productDiv = document.createElement("div");
        productDiv.classList.add("product");
        productDiv.innerHTML = `
            <img src="${product.image}" alt="${product.name}" class="default-image">
            <h3 class="product-title">${product.name}</h3>
        `;
        productDiv.addEventListener("click", () => {
            console.log("Product clicked:", product.name); // Debugging line
            showProductModal(product);
        });
        dom.productGrid.appendChild(productDiv);
    });
}

        // Favorite button functionality
        const favoriteBtn = document.getElementById('favoriteBtn');
const favoriteModal = document.getElementById('favoriteModal');
let isFavoriteModalOpen = false;

favoriteBtn.addEventListener('click', () => {
    isFavoriteModalOpen = !isFavoriteModalOpen;
    favoriteModal.style.display = isFavoriteModalOpen ? 'block' : 'none';
    updateFavoriteButtonIcon();
});

function addToFavorites(productName) {
    let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

    if (favorites.includes(productName)) {
        // Remove from favorites
        favorites = favorites.filter(item => item !== productName);
        alert(`${productName} removed from favorites.`);
    } else {
        // Add to favorites
        favorites.push(productName);
        alert(`${productName} added to favorites.`);
    }

    // Save updated favorites to localStorage
    localStorage.setItem("favorites", JSON.stringify(favorites));

    // Refresh the modal to reflect the updated favorite status
    const currentProduct = products.find(product => product.name === productName);
    showProductModal(currentProduct);
}

function updateFavoriteButtonIcon() {
    const favorites = JSON.parse(localStorage.getItem("favorites")) || [];
    favoriteBtn.textContent = favorites.length > 0 ? '‚ù§Ô∏è' : 'ü§ç';
}

// Close the favorite modal when clicking outside
document.addEventListener('click', (event) => {
    if (favoriteBtn && favoriteModal) {
        if (!favoriteBtn.contains(event.target) && !favoriteModal.contains(event.target)) {
            isFavoriteModalOpen = false;
            favoriteModal.style.display = 'none';
        }
    }
});

// Function to remove a favorite item
function removeFavorite(productName) {
    let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

    // Remove the item from the favorites array
    favorites = favorites.filter(item => item !== productName);

    // Save updated favorites to localStorage
    localStorage.setItem("favorites", JSON.stringify(favorites));

    // Reload favorites to reflect changes
    loadFavorites();
    alert(`${productName} removed from favorites.`);
}

// Load favorite items into the mini modal
function loadFavorites() {
    const favorites = JSON.parse(localStorage.getItem("favorites")) || [];
    const favoriteList = document.getElementById("favoriteList");

    if (favorites.length === 0) {
        favoriteList.innerHTML = "<li>No favorites yet.</li>";
        return;
    }

    favoriteList.innerHTML = favorites
        .map(
            (item) => `
                <li>
                    ${item}
                    <button class="quick-add" onclick="addToCart('${item}')">+</button>
                    <button class="remove-favorite" onclick="removeFavorite('${item}')">√ó</button>
                </li>
            `
        )
        .join("");
}

// Toggle favorite status
function toggleFavorite(productName) {
    let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
    if (favorites.includes(productName)) {
        favorites = favorites.filter(item => item !== productName); // Remove from favorites
    } else {
        favorites.push(productName); // Add to favorites
    }
    localStorage.setItem("favorites", JSON.stringify(favorites));
    alert(`${productName} ${favorites.includes(productName) ? "added to" : "removed from"} favorites.`);
    showProductModal({ name: productName }); // Refresh modal to update button text
}

// Function to initialize event listeners
function initializeEventListeners() {
    if (dom.productModal) {
        // Close modal when clicking outside
        dom.productModal.addEventListener('click', (e) => {
            if (e.target === dom.productModal) {
                dom.productModal.style.display = 'none';
            }
        });

        // Close modal when clicking the close button
        const closeButton = dom.productModal.querySelector('.close');
        if (closeButton) {
            closeButton.addEventListener('click', () => {
                dom.productModal.style.display = 'none';
            });
        }
    } else {
        console.error("Product modal element not found!");
    }
}

// Initialize dashboard
document.addEventListener("DOMContentLoaded", () => {
    console.log("Initializing dashboard..."); // Debugging line
    updateDeliveryStatus();
    updateDailyRecommendation();
    updatePopularMochi();
    initializeEventListeners();
});
    </script>
</body>
</html>

